# PhishX Environment Configuration

# ========================================
# Core Configuration
# ========================================

# Environment type (development, staging, production)
ENVIRONMENT=development

# Service identification
SERVICE_NAME=PhishX
SERVICE_VERSION=1.0.0

# ========================================
# Database Configuration
# ========================================

# PostgreSQL connection string
DATABASE_URL=postgresql://phishx:phishx_secure_password@localhost:5432/phishx_db

# ========================================
# Redis & Message Queue Configuration
# ========================================

# Redis URL (main cache & session store)
REDIS_URL=redis://:redis_secure_password@localhost:6379/0

# Celery broker URL (message queue)
CELERY_BROKER_URL=redis://:redis_secure_password@localhost:6379/1

# Celery result backend (task results storage)
CELERY_RESULT_BACKEND=redis://:redis_secure_password@localhost:6379/2

# ========================================
# Security & API Keys
# ========================================

# API authentication key (change in production!)
API_KEY=your-secure-api-key-here-change-me

# Secret key for JWT encoding (change in production!)
SECRET_KEY=your-secret-key-here-change-me

# ========================================
# External Services Integration
# ========================================

# NLP Service URL for text analysis
NLP_SERVICE_URL=http://nlp:8001/predict

# ClamAV antivirus service
CLAMAV_HOST=localhost
CLAMAV_PORT=3310

# Threat Intelligence Feed URLs (optional)
THREAT_INTEL_URLS=https://phishtank.com/api_config.php,https://urlhaus-api.abuse.ch/v1/urls/latest/

# ========================================
# Logging Configuration
# ========================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log format (json or text)
LOG_FORMAT=json

# Log output destination (stdout, file, or both)
LOG_OUTPUT=both

# Log directory path
LOG_DIR=logs

# ========================================
# CORS Configuration
# ========================================

# Allowed origins for CORS (comma-separated)
CORS_ORIGINS=*

# ========================================
# Rate Limiting Configuration
# ========================================

# Rate limit per IP (requests per minute)
RATE_LIMIT_IP=100/minute

# Rate limit per API key (requests per hour)
RATE_LIMIT_KEY=10000/hour

# Rate limit per tenant (emails per day)
RATE_LIMIT_TENANT=1000000/day

# ========================================
# Server Configuration
# ========================================

# Server port
PORT=8000

# Number of worker processes
WORKERS=4

# ========================================
# Feature Flags (Phase 2+)
# ========================================

# Enable async processing (default: true)
ASYNC_PROCESSING=true

# Enable circuit breakers (default: false in dev, true in prod)
ENABLE_CIRCUIT_BREAKERS=false

# Enable machine learning models (default: true)
ENABLE_ML_MODELS=true

# Shadow mode for model testing (default: false)
ENABLE_SHADOW_MODELS=false

# ========================================
# Phase 3: JWT Authentication
# ========================================

# Enable JWT authentication (default: false for backward compatibility)
ENABLE_JWT_AUTH=false

# JWT algorithm (HS256 for symmetric, RS256 for asymmetric)
JWT_ALGORITHM=HS256

# JWT secret key for HS256 (change in production!)
JWT_SECRET_KEY=your-jwt-secret-key-here-change-me-min-32-chars

# JWT access token expiration in minutes (default: 15)
JWT_ACCESS_TOKEN_EXPIRE=15

# JWT refresh token expiration in days (default: 30)
JWT_REFRESH_TOKEN_EXPIRE=30

# ========================================
# Phase 3: Database Field Encryption
# ========================================

# Enable field-level encryption (default: false)
ENCRYPTION_ENABLED=false

# Master encryption key (base64 encoded 32-byte key)
# Generate with: python -c "import os; print(os.urandom(32).hex())"
ENCRYPTION_MASTER_KEY=

# Key rotation interval in days
KEY_ROTATION_INTERVAL=90

# ========================================
# Phase 3: Anomaly Detection
# ========================================

# Enable anomaly detection (default: true)
ANOMALY_DETECTION_ENABLED=true

# Anomaly confidence threshold for alerting (0.0-1.0)
ANOMALY_CONFIDENCE_THRESHOLD=0.8

# Send alerts to SOC when anomalies detected (default: true)
ANOMALY_ALERT_ON_DETECTION=true

# Sliding window size for anomaly detection
ANOMALY_SLIDING_WINDOW_SIZE=1000

# Z-score threshold for statistical anomaly detection
ANOMALY_ZSCORE_THRESHOLD=3.0

# IQR threshold multiplier for outlier detection
ANOMALY_IQR_THRESHOLD=1.5

# ========================================
# Phase 3: Shadow Models & A/B Testing
# ========================================

# Enable shadow model experiments (default: false)
SHADOW_MODELS_ENABLED=false

# Currently active shadow experiment ID (optional)
ACTIVE_EXPERIMENT_ID=

# Currently active canary deployment ID (optional)
ACTIVE_CANARY_ID=

# Traffic percentage to canary model (0-100)
CANARY_TRAFFIC_PERCENTAGE=0

# Canary deployment strategy (linear or exponential)
CANARY_STRATEGY=linear

# ========================================
# Phase 3: Multi-Region Deployment
# ========================================

# Enable multi-region failover (default: false)
MULTI_REGION_ENABLED=false

# Primary region ID
PRIMARY_REGION=us-east-1

# Secondary region ID
SECONDARY_REGION=eu-west-1

# Failover trigger threshold (seconds of health check failures)
FAILOVER_THRESHOLD_SECONDS=60

# Health check interval (seconds)
HEALTH_CHECK_INTERVAL=30

# Replication lag tolerance (seconds)
REPLICATION_LAG_TOLERANCE=5

# ========================================
# Development Only
# ========================================

# Debug mode (set to false in production)
DEBUG=true

# Enable swagger docs (set to false in production)
ENABLE_SWAGGER=false

# Enable database migrations on startup
AUTO_MIGRATE_DB=true
